<div class="table">
    <p-table #dt2
    [columns]="selectedColumns" 
    [value]="customers" 
    [tableStyle]="{'min-width': '50rem', 'table-layout': 'fixed', 'width': '100%'}"
    [globalFilterFields]="['name', 'contact', 'degree', 'skills', 'workExperience']">
        <ng-template pTemplate="caption">
            <div class="flex justify-content-between items-center">
                <!-- <div>
                    <div class="position-head">{{ position }}</div>
                </div> -->
                <div>
                    <span class="p-input-icon-left">
                        <i class="pi pi-search"></i>
                        <input pInputText type="text" (input)="filterGlobal($event, 'contains')" placeholder="Search keyword" />
                    </span>
                </div>
                <p-multiSelect 
                display="chip" 
                [options]="cols" 
                [(ngModel)]="selectedColumns" 
                optionLabel="header"
                selectedItemsLabel="{0} columns selected" 
                [style]="{'min-width': '250px'}" 
                placeholder="Choose Columns" />
            </div>            
        </ng-template>
        
        <ng-template pTemplate="header" let-columns>
            <tr>
                <th class="column column-name">Name</th> 
                <th class="column column-contact">Contact</th>
                <th class="column column-degree" style="width: auto;">Degree</th>
                <th class="column column-skills" style="width: auto;">Skills</th>
                <th *ngFor="let col of columns" style="width: auto;">
                    {{col.header}}
                </th>
                <th class="column column-action" style="width: auto;">Action</th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-customer let-columns="columns">
            <tr>
                <td>                
                    {{ customer.name }}
                    <div class="view-cv">
                        <a href="{{ customer.cv }}" target="_blank">View CV</a>
                    </div>
                </td>
                <td>{{customer.contact}}</td>
                <td>{{customer.skills}}</td>
                <td>{{customer.degree}}</td>
                <td *ngFor="let col of columns">
                    <ng-container *ngIf="col.field === 'comment' && customer?.id">
                        <p-button (onClick)="showDialog(customer)" label="Comment" class="small-button" 
                        [style]="{ 'background-color': 'var(--green-400)', 'color': 'white', 'border-color': 'var(--green-400)', 'font-size': '13px' }"/>
                        <p-dialog *ngIf="selectedCustomer" header="Enter your comment:" [modal]="true" [(visible)]="visible" [style]="{ width: '25rem' }">
                          <div class="flex align-items-center gap-3 mb-3">
                            <label for="comment" class="font-semibold w-6rem">Comment</label>
                            <textarea pInputText 
                                      id="comment-{{ selectedCustomer.id || '' }}" 
                                      class="flex-auto" 
                                      rows="4" 
                                      cols="20" 
                                      autocomplete="off" 
                                      [(ngModel)]="selectedCustomer.comment" 
                                      [disabled]="!selectedCustomer || !checkCommentExist(jobId, selectedCustomer.id)">
                            </textarea>
                          </div>
                          <div class="flex justify-content-end gap-2">
                            <p-button label="Cancel" severity="secondary" (onClick)="visible = false" />
                            <p-button label="Save" (click)="submitComment()" />
                          </div>
                        </p-dialog>
                      </ng-container>
                                            
                    <ng-container *ngIf="col.field === 'available_Date'">
                        {{ customer[col.field] | date:'yyyy-MM-dd' }}
                    </ng-container>
                    <!-- <ng-container *ngIf="col.field === 'experience'; else normalCell"> -->
                    <ng-container *ngIf="col.field === 'experience'">
                        {{customer[col.field]}}
                    </ng-container>
                    <!-- <ng-template #normalCell>
                        {{customer[col.field]}}
                    </ng-template> -->
                </td>
                <td>
                    <!-- <div class="status">{{ showStatus(customer.role_Id) }} </div> -->
                    <div class="button-container">                  
                        <p-button (onClick)="updateRoleId(customer.id, 1)" label="Accept" [outlined]="true" class="accept-button small-button" [style]="{ 'font-size': '13px', 'color': '--green-400' }"/>
                        <p-button (onClick)="updateRoleId(customer.id, 7)" *ngIf="customer.role_Id===0" label="Remove" severity="danger" [outlined]="true" class="small-button" [style]="{ 'font-size': '13px' }"/>
                        <p-toast />
                        <p-confirmDialog #cd>
                            <ng-template pTemplate="headless" let-message>
                                <div class="flex flex-column align-items-center p-5 surface-overlay border-round">
                                    <span class="font-bold text-2xl block mb-2 mt-4">
                                        {{ message.header }}
                                    </span>
                                    <p class="mb-0">{{ message.message }}</p>
                                    <div class="flex align-items-center gap-2 mt-4">
                                        <button 
                                            pButton 
                                            label="Delete" 
                                            (click)="cd.accept()" 
                                            class="w-6rem"
                                            [style]="{ 'background-color': 'var(--red-600)', 'border-color': 'var(--red-600)' }">
                                        </button>
                                        <button 
                                            pButton 
                                            label="Cancel" 
                                            (click)="cd.reject()" 
                                            class="p-button-outlined w-6rem "
                                            [style]="{ 'color': 'var(--red-600)', 'border-color': 'var(--red-600)' }">
                                        </button>
                                    </div>
                                </div>
                            </ng-template>
                        </p-confirmDialog>
                        <p-button (onClick)="confirmDelete(customer.id)" *ngIf="customer.role_Id===7" label="Delete" severity="danger" [outlined]="true" class="small-button" [style]="{ 'font-size': '13px' }"/>
                    </div>
                </td>
            </tr>
        </ng-template>
    </p-table>
</div>